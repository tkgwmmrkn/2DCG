2D図化・インプット作成プログラム

竹川 遊大 - 2021/11/02

本プログラムについて

　このプログラムはMPMプログラムのインプット作成、結果データの図化を行うプログラムです。

本プログラムの変遷

- 2020：ジオフロントシステム工学研究室のMPMプログラム向けに作成。
- 2021：土木施工システム工学研究室に引き継ぎ

本プログラムの使い方

・[インプット](#_%E3%82%A4%E3%83%B3%E3%83%97%E3%83%83%E3%83%88%E4%BD%9C%E6%88%90%E6%96%B9%E6%B3%95)[(粒子)](#_%E3%82%A4%E3%83%B3%E3%83%97%E3%83%83%E3%83%88%E4%BD%9C%E6%88%90%E6%96%B9%E6%B3%95)

・[インプット](#_%E3%82%A4%E3%83%B3%E3%83%97%E3%83%83%E3%83%88%E4%BD%9C%E6%88%90%E6%96%B9%E6%B3%95%EF%BC%88%E7%B2%92%E5%AD%90+APDI%EF%BC%89)[(粒子+APDI)](#_%E3%82%A4%E3%83%B3%E3%83%97%E3%83%83%E3%83%88%E4%BD%9C%E6%88%90%E6%96%B9%E6%B3%95%EF%BC%88%E7%B2%92%E5%AD%90+APDI%EF%BC%89)

・[インプット](#_%E3%82%A4%E3%83%B3%E3%83%97%E3%83%83%E3%83%88%E4%BD%9C%E6%88%90%E6%96%B9%E6%B3%95%EF%BC%88%E5%A2%83%E7%95%8C%E6%9D%A1%E4%BB%B6%EF%BC%89)[(境界条件)](#_%E3%82%A4%E3%83%B3%E3%83%97%E3%83%83%E3%83%88%E4%BD%9C%E6%88%90%E6%96%B9%E6%B3%95%EF%BC%88%E5%A2%83%E7%95%8C%E6%9D%A1%E4%BB%B6%EF%BC%89)

・[インプットの模式図](#_%E3%82%A4%E3%83%B3%E3%83%97%E3%83%83%E3%83%88%E3%81%AE%E6%A8%A1%E5%BC%8F%E5%9B%B3)

・[結果データの図化](#結果データの図化)

### インプット作成方法（粒子のみ)

GIMPのみのインプット作成方法を記述する。

1. モデルを準備する

1. htmlをGoogle Chromeで開く

1. 粒子(MP)追加

  1. 粒子情報からMP追加

粒子座標からMP追加… 等間隔でGIMP粒子を生成する。

「始点」

「終点」

「間隔」を入力する。

「適用」を押すと粒子が配置される。

（&quot;格子座標からMP追加&quot; は端部格子点の座標と格子内粒子数を入力する。）

input\_mp.dat の内容は左図のように生成される。

粒子番号　X座標　Y座標　材料番号

5文字　　 10文字 10文字　5文字

(_アウトプットのフォーマット変更方法_-->_ソースを編集するしかない_)

  1. 格子情報からMP追加

「始点」

「終点」

「格子幅」を入力する。

「格子内MP数」は1格子あたりの粒子数を入力する。

「適用」を押すと粒子が配置される。

1. input\_mp.datを保存

### インプット作成方法（粒子+APDI）

要素-粒子混成法のインプット作成方法を示す。しかし、例を示したほうがわかりやすいと思い、ここでは実際に卒論で使用したモデルの作成手順を並べる。

1. モデル作成

モデル作成の注意点：

・APDI要素がすべて4頂点を持つようにモデル化をしなければならない。

・変形が大きい場所ではGIMPを使うため、変形の大きい場所を予め予測しておく必要がある。

・モデル右端のAPDI頂点は、右端格子点のほんの少し左側に置いておかなければならない。というのも、頂点が所属する格子が仮想セルになってしまうと、解析が正しく動作しないためである。&quot;モデル右端&quot;を判定するため、まずは&quot;設定&quot;より解析領域を設定する。

1. 計算領域を入力する。

計算領域は仮想セルを含めた長さを入力する。これはconfig.datに載せる計算領域データと同じ値となる。

1. GIMP粒子を生成する。

1. 正方形のAPDIを生成する。

1. バッファー要素(複雑な形のAPDI)を生成する。

1. input\_mp.dat、input\_apdi.datを保存する。

### インプット作成方法（境界条件）

境界条件はMPやAPDIと独立した情報であり、config.datの一部のみを生成する。境界条件をこのプログラムで生成する理由は

・プレビューに境界条件も図示するため

・モデルの位置が正しいか確認するため

・境界条件が正しいか確認するため

ことであり、解析を行う際には必ずしも必須ではない。境界条件は手書きで入力するのと手間が変わらない。

1. モデルの作成

1. 境界条件を追加

境界条件の表示は△をクリックすると反転可能

### インプットの模式図

このプログラムには、プレビューのスタイル設定機能と、各種ID表示機能がある。

テキストボックスの数値を変更し、スタイルを調節する。

SVG画像拡大倍率とSVGキャンバス横幅は固定で良いと思われる。

他の設定は都度変更する。

### 結果データの図化

結果データを読み込み、数値を色合いで可視化するコンター図を作成する。

1. 結果データを読み込み(beta)を使用

1. ソリューションを含むフォルダを選択し、「Upload」

1. フォルダをクリックすると中身を表示できる。

1. 最初に、config.datをクリックする。クリックすると選択が完了した状態となる。

1. 次に、混成法ではvertex\_pos.datを選択する。GIMPのみの場合では、スキップを押す。

1. 最後に、図示したいデータのデータファイルを選択する。よく図化するのはsigm, epsv, ep, shear-strain, shear-stress。今回はsigm.datを読み込む。sigm.datをクリックすると下図のような表示が出る。

config.datからは粒子数、格子点数を読み込んでいる。

ただし、config.datのコメント部分を読んでるので、

- 固相マテリアルポイントの数
- APDIを用いる
- X方向背景計算格子長さ
- Y方向背景計算格子長さ
- 計算格子幅
- MPM初期粒子支配領域の幅 or 初期粒子支配領域の幅

以外ではエラーとなり、入力を迫られる。

1. 図を操作する方法について

キーボードの矢印キーまたは、表示されるアイコンやシークバー(操作盤)によって時間を進めることができる。
　
1. 動画の保存方法 --> 連番ファイルを保存

「連番ファイルを保存」をクリックする前に、時間ステップを一番最初まで戻す。

次に、「連番ファイルを保存」をクリックし、シークバーの再生ボタン▶を押す。録画中においては新たに描画される画像を自動的にZIPに追加する。すべてのステップでの画像が描画し終わったら、「連番ファイルを保存」を押す。ZIPの圧縮が完了したら自動的にZIPが保存される。

1. 設定項目について

表示するデータ：図化に使用するデータのオフセット(左から何番目)

X座標データ：X座標として使用するデータのオフセット(左から何番目)

Y座標データ：Y座標として使用するデータのオフセット(左から何番目)

格子点のデータとして描画：格子点データを描画する際にチェックを入れる。

データの範囲：例えばepsvなら-0.1~0.5　sigmなら0~400　shear-strainなら0~1

レジェンド数値の文字列長さ：レジェンドに表示する数字の文字数

レジェンドの位置：レジェンドの左端からの位置

白カラーテーマを使用：黒背景を使用するか、白背景を使用するか

変更後は「適用して再描画」をクリック。

現在フレームを保存：現在表示している画像をSVG/PNG/JPGで保存する。

連番ファイルを保存：動画を保存

再生速度(描画フレーム間隔)：再生ボタンを押した際、何フレームに1回表示するか。4と設定すると、t=1の次、t=5を描画する。